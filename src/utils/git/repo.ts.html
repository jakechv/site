<!DOCTYPE html><html ><head ><meta charset="utf-8"></meta><title >repo.ts / Jake Chvatal</title><meta property="og:title" content="repo.ts"></meta><meta property="og:type" content="website"></meta><meta property="og:url" content="file:///Users/jake/Documents/personal/site/docs"></meta><meta property="og:site_name" content="Jake Chvatal"></meta><meta name="keywords" content="jake"></meta><meta name="author" content="Jake Chvatal"></meta><meta name="robots" content="index,follow"></meta><meta name="description" content="hi"></meta><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"></meta><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#111"></meta><link rel="icon" type="image/x-icon" href="/Users/jake/Documents/personal/site/favicons/favicon.ico"></link><link rel="apple-touch-icon" href="/Users/jake/Documents/personal/site/favicons/apple-touch-icon.png"></link><link rel="stylesheet" type="text/css" href="/resources/style.css" id="/resources/style.css"></link><link rel="stylesheet" type="text/css" href="/resources/global.css" id="/resources/global.css"></link><script src="/resources/lib.js" id="/resources/lib.js" type="module"></script><link rel="stylesheet" type="text/css" href="/resources/elements.css" id="/resources/elements.css"></link><link rel="manifest" href="/resources/manifest.json"></link><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/nord.min.css" id="dark-theme-highlight"></link><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css" id="light-theme-highlight"></link><script src="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js" id="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js" type="undefined"></script><script src="/resources/elements.js" id="/resources/elements.js" type="module" defer="true"></script></head><body ><link rel="stylesheet" href="/components/Sidebar/sidebar.css"></link><div class="sidebar"><div class="url-path"><b >jake.</b><span > / </span><a href="file:///Users/jake/Documents/personal/site/docs/src/index.html">src</a><span > / </span><a href="file:///Users/jake/Documents/personal/site/docs/src/utils/index.html">utils</a><span > / </span><a href="file:///Users/jake/Documents/personal/site/docs/src/utils/git/index.html">git</a><span > / </span><b >repo.ts</b></div><script src="/components/ToggleDarkMode/toggle-dark-mode.js" type="module"></script><link rel="stylesheet" href="/components/ToggleDarkMode/toggle-dark-mode.css"></link><div class="toggle-dark-mode-container"><button class="toggle-dark-mode"></button></div></div><div class="site-body"><main ><article class="wikipage"><h1 class="title-top">repo.ts</h1><pre ><code class="language-ts has-raw-code">import { execSync } from &quot;../cmd&quot;;
import { Path } from &quot;../path&quot;;
import RepoFile from &quot;./repofile&quot;;

/**
 * a git repository is a directory with a .git subdirectory
 * This is basically a git porcelain that keeps the current repo
 */
class Repo {
  // the full path to the repository
  // this is the directory that contains the .git subdirectory
  public path: Path;

  constructor(path: Path) {
    this.path = path;
  }

  static create(sourcePath: Path) {
    return new Repo(sourcePath);
  }

  /**
   * Get a reference to the git repo&#x27;s file at the provided path.
   * @param atPath
   * @returns
   */
  getFile(atPath: Path) {
    if (!this.path.contains(atPath)) {
      throw new Error(`File ${atPath} is not in the repository`);
    }

    return RepoFile.create(this, atPath);
  }

  /**
   * Run a command from this git repository&#x27;s root.
   */
  runCmd(command: string) {
    const cmdResult = execSync(command, { cwd: this.path.toString() });
    return cmdResult.toString();
  }

  checkout(branchName: string) {
    return this.runCmd(`git checkout ${branchName}`);
  }

  addAll() {
    console.log(&quot;adding all to git&quot;);
    this.runCmd(&quot;git add .&quot;);
  }

  commit(message = &quot;robot commit&quot;) {
    console.log(&quot;committing&quot;, { message });
    this.runCmd(`git -c commit.gpgsign=false commit -m &quot;${message}&quot;`);
  }

  push() {
    this.runCmd(&quot;git push&quot;);
  }

  removeUntracked() {
    this.runCmd(&quot;git clean -fxd&quot;);
  }

  currentBranch() {
    const branch = this.runCmd(&quot;git branch --show-current&quot;);
    console.log(&quot;current branch&quot;, branch);
    return branch;
  }

  status() {
    const status = this.runCmd(&quot;git status&quot;);
    console.log(status);
  }

  stash() {
    this.runCmd(&quot;git stash&quot;);
  }

  stashPop() {
    this.runCmd(&quot;git stash pop&quot;);
  }
}

export default Repo;
</code></pre></article></main><div class="article-rhs-container"><div class="article-rhs"><div class="git-history-table-container"><span class="git-history-table-title">Revisions</span><table class="git-history-table"><thead ><tr ><th >Date</th><th >Hash</th></tr></thead><tbody ><tr ><td class="commit-date-tr">2024-04-13</td><td class="commit-link-tr">0c9b2c0e</td></tr><tr ><td class="commit-date-tr">2024-04-13</td><td class="commit-link-tr">aaec0997</td></tr><tr ><td class="commit-date-tr">2024-04-13</td><td class="commit-link-tr">b029c988</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">a3c37e13</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">cefa4cf3</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">bce55469</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">110e0165</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">02dca1b8</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">dec57c39</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">692ce828</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">9a544393</td></tr></tbody></table></div><div class="prev-next-up-buttons-container">Navigation<table class="prev-next-up-buttons"><tr ><td >Next</td><td ><a class="next-button" href="file:///Users/jake/Documents/personal/site/docs/src/utils/git/commit.ts.html">commit.ts</a></td></tr><tr ><td >Up</td><td ><a class="up-button" href="file:///Users/jake/Documents/personal/site/docs/src/utils/git.html">git</a></td></tr></table></div></div></div></div></body></html>