<!DOCTYPE html><html ><head ><meta charset="utf-8"></meta><title >file.ts / Jake Chvatal</title><meta property="og:title" content="file.ts"></meta><meta property="og:type" content="website"></meta><meta property="og:url" content="https://jake.isnt.online"></meta><meta property="og:site_name" content="Jake Chvatal"></meta><meta name="keywords" content="jake"></meta><meta name="author" content="Jake Chvatal"></meta><meta name="robots" content="index,follow"></meta><meta name="description" content="hi"></meta><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"></meta><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#111"></meta><link rel="icon" type="image/x-icon" href="/Users/jake/Documents/personal/site/favicons/favicon.ico"></link><link rel="apple-touch-icon" href="/Users/jake/Documents/personal/site/favicons/apple-touch-icon.png"></link><link rel="stylesheet" type="text/css" href="/resources/style.css" id="/resources/style.css"></link><link rel="stylesheet" type="text/css" href="/resources/global.css" id="/resources/global.css"></link><script src="/resources/lib.js" id="/resources/lib.js" type="module"></script><link rel="stylesheet" type="text/css" href="/resources/elements.css" id="/resources/elements.css"></link><link rel="manifest" href="/resources/manifest.json"></link><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/nord.min.css" id="dark-theme-highlight"></link><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css" id="light-theme-highlight"></link><script src="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js" id="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js" type="undefined"></script><script src="/resources/elements.js" id="/resources/elements.js" type="module" defer="true"></script></head><body ><link rel="stylesheet" href="/components/Sidebar/sidebar.css"></link><div class="sidebar"><div class="url-path"><b >jake.</b><span > / </span><a href="https://jake.isnt.online/src/index.html">src</a><span > / </span><a href="https://jake.isnt.online/src/file/index.html">file</a><span > / </span><a href="https://jake.isnt.online/src/file/classes/index.html">classes</a><span > / </span><b >file.ts</b></div><script src="/components/ToggleDarkMode/toggle-dark-mode.js" type="module"></script><link rel="stylesheet" href="/components/ToggleDarkMode/toggle-dark-mode.css"></link><div class="toggle-dark-mode-container"><button class="toggle-dark-mode"></button></div></div><div class="site-body"><main ><article class="wikipage"><h1 class="title-top">file.ts</h1><pre ><code class="language-ts has-raw-code">import { Path } from &quot;../../utils/path&quot;;
import { readFile } from &quot;file&quot;;
import Directory from &quot;../filetype/directory&quot;;
import type { PageSettings } from &quot;../../types/site&quot;;

/**
 * Any file on the system.
 */
class File {
  // the full path to the file
  public path: Path;

  /**
   * Construct a file.
   */
  constructor(pathArg: Path) {
    const filePath = Path.create(pathArg);

    if (!filePath.exists()) {
      throw new Error(
        `from File constructor: File at path &#x27;${pathArg}&#x27; does not exist`
      );
    }

    this.path = filePath;
  }

  static create(path: Path) {
    return new this(path);
  }

  /**
   * Two files are equal if their paths are equal.
   */
  equals(file: File) {
    return this.path.equals(file.path);
  }

  clone(): typeof this {
    // note: `this.constructor` is always callable as a constructor,
    // but TypeScript doesn&#x27;t seem to have a special notion of a &#x27;constructor&#x27;
    // function that can be invoked like an arbitrary function.
    // Not even sure it&#x27;s possible with the JS spec.
    return new (this.constructor as any)(this.path);
  }

  // read the file at the path
  read() {
    throw new Error(&quot;File.read() is not implemented&quot;);
  }

  // the title of the file does not
  get title() {
    return this.name.split(&quot;.&quot;)[0];
  }

  // the name of a file includes the extension
  get name() {
    return this.path.name;
  }

  // the type of the file is the extension (for now?)
  get extension() {
    return this.path.extension;
  }

  // get the mime type of the file
  get mimeType() {
    return this.path.mimeType;
  }

  /**
   * Get the parent directory of this file.
   */
  get directory(): Directory {
    // A `parent` file, by definition, is a directory that contains this one.
    return readFile(this.path.parent) as any as Directory;
  }

  /**
   * Determine if the file is a directory.
   * Always false here; directory subclass reimplements this.
   */
  isDirectory(): this is Directory {
    return false;
  }

  write(config: PageSettings): typeof this {
    console.error(
      `file.write() is not implemented for file at &#x27;${this.path.toString()}&#x27;`
    );

    return this;
  }

  // get the url to the html page with this file
  // if provided a directory, get the url to the directory with index.html postfixed (?)
  htmlUrl({ rootUrl, sourceDir }: { rootUrl: string; sourceDir: string }) {
    const relativeToSource = this.path.relativeTo(sourceDir);

    const isRootPath =
      !relativeToSource.toString().length ||
      relativeToSource?.toString() === &quot;/&quot;;

    if (isRootPath) {
      return rootUrl + &quot;/index.html&quot;;
    }

    return rootUrl + relativeToSource.toString() + &quot;.html&quot;;
  }

  get repo() {
    const repoAtPath = this.path.repo;
    if (!repoAtPath) {
      console.log(
        `From File.repo: File at path &#x27;${this.path}&#x27; is not in a repo`
      );
      return null;
    }

    return repoAtPath;
  }

  get lastLog() {
    return this.repo?.getFile(this.path)?.lastLog;
  }

  get log() {
    return this.repo?.getFile(this.path)?.log ?? [];
  }

  get lastTimestamp() {
    return this.repo?.getFile(this.path).lastTimestamp;
  }

  // by default, files do not depend on any other files.
  dependencies(settings: PageSettings): File[] {
    return [];
  }

  /**
   * Serve the file.
   * By default, this should serve the file as a binary?
   */
  serve(args: PageSettings): { contents: string; mimeType: string } {
    throw new Error(&quot;File.serve() is not implemented&quot;);
  }

  /**
   * Watch the file, attaching an event listener to pick up on file events.
   */
  watch(callback: (eventType: string, file: File) =&gt; void) {
    const closeWatcher = this.path.watch(
      (eventType: string, filename: string) =&gt; {
        callback(eventType, this);
      }
    );

    return closeWatcher;
  }
}

export default File;
</code></pre></article></main><div class="article-rhs-container"><div class="article-rhs"><div class="git-history-table-container"><span class="git-history-table-title">Revisions</span><table class="git-history-table"><thead ><tr ><th >Date</th><th >Hash</th></tr></thead><tbody ><tr ><td class="commit-date-tr">2024-04-13</td><td class="commit-link-tr">0c9b2c0e</td></tr><tr ><td class="commit-date-tr">2024-04-12</td><td class="commit-link-tr">e5f68a85</td></tr><tr ><td class="commit-date-tr">2024-04-12</td><td class="commit-link-tr">0d786479</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">a3c37e13</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">04949a2f</td></tr><tr ><td class="commit-date-tr">2024-04-01</td><td class="commit-link-tr">110e0165</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">51ac9ed3</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">02dca1b8</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">b2bdfc1f</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">95fa0ee8</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">175f29ec</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">3e22c4b6</td></tr><tr ><td class="commit-date-tr">2024-03-31</td><td class="commit-link-tr">9a544393</td></tr></tbody></table></div><div class="prev-next-up-buttons-container">Navigation<table class="prev-next-up-buttons"><tr ><td >Previous</td><td ><a class="prev-button" href="https://jake.isnt.online/src/file/classes/text.ts.html">text.ts</a></td></tr><tr ><td >Next</td><td ><a class="next-button" href="https://jake.isnt.online/src/file/classes/index.ts.html">index.ts</a></td></tr><tr ><td >Up</td><td ><a class="up-button" href="https://jake.isnt.online/src/file/classes.html">classes</a></td></tr></table></div></div></div></div></body></html>